<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
    http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <changeSet id="GAZA_CONFIG_20221115124103046" author="Shobana">
        <comment>Adding Concepts for PatientProgressNote Form</comment>
        <sqlFile path="PatientProgressNote/PatientProgressNote.sql"/>
    </changeSet>

    <changeSet id="GAZA_CONFIG_2022111712410312" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="1">
                select count(*) from concept_name  where name = "DISCHARGE" and concept_name_type = "FULLY_SPECIFIED" and locale ="en" and voided = 0;
            </sqlCheck>
        </preConditions>
        <comment>Delete child concept DISCHARGE</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name ="DISCHARGE" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            delete from concept_name where concept_id = @concept_id;
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221117124103840" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_name  where name = "Discharge" and concept_name_type = "FULLY_SPECIFIED" and locale ="en" and voided = 0;
            </sqlCheck>
        </preConditions>
        <comment>Add child concept Discharge for Patient progress Note</comment>
        <sql>
            set @concept_id = 0;
            set @concept_short_id = 0;
            set @concept_full_id = 0;
            call add_concept(@concept_id,@concept_short_id,@concept_full_id,"Discharge","Discharge","N/A","Misc",false);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124103840" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Follow-up", "Discharge")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Type of visit");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Type of visit</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Type of visit" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Follow-up" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Discharge" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124104123" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Procedural pain", "Background pain")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Type of Pain");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Type of Pain</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Type of Pain" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Procedural pain" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Background pain" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124105277" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Open non-healing wound", "Wound intact and healing", "Wound infection", "SSI", "PTI", "Other")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Examination findings");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Examination findings</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Examination findings" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Open non-healing wound" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Wound intact and healing" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Wound infection" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="SSI" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="PTI" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="Other" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124106341" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Ambulance", "Car", "None")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Transportation need");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Transportation need</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Transportation need" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Ambulance" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Car" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="None" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124107943" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("None", "First level pain reliever", "Second level pain reliever", "EMONO", "Sedation", "TENS", "Trigger Point")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Pain management");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Pain management</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Pain management" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            set @child7_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="None" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="First level pain reliever" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Second level pain reliever" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="EMONO" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="Sedation" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="TENS" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child7_concept_id from concept_name where name ="Trigger Point" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
            call add_concept_answer(@concept_id, @child7_concept_id, 7);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124108834" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Lab request", "Surgical procedure", "Suture removal", "Clips removal", "Dressing", "Physiotherapy")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Wound management");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Wound management</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Wound management" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Lab request" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Surgical procedure" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Suture removal" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="Clips removal" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="Dressing" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="Physiotherapy" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124110753" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Daily", "4 times a week", "3 times a week", "2 times a week", "Once a week", "Once every 2 weeks", "Once every 3 weeks", "Once a month", "Once every 6 weeks", "Once every 2 months")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Physiotherapy frequency");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Physiotherapy frequency</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Physiotherapy frequency" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            set @child7_concept_id = 0;
            set @child8_concept_id = 0;
            set @child9_concept_id = 0;
            set @child10_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Daily" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="4 times a week" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="3 times a week" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="2 times a week" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="Once a week" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="Once every 2 weeks" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child7_concept_id from concept_name where name ="Once every 3 weeks" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child8_concept_id from concept_name where name ="Once a month" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child9_concept_id from concept_name where name ="Once every 6 weeks" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child10_concept_id from concept_name where name ="Once every 2 months" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
            call add_concept_answer(@concept_id, @child7_concept_id, 7);
            call add_concept_answer(@concept_id, @child8_concept_id, 8);
            call add_concept_answer(@concept_id, @child9_concept_id, 9);
            call add_concept_answer(@concept_id, @child10_concept_id, 10);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124112572" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Daily", "4 times a week", "3 times a week", "2 times a week", "Once a week", "Once every 2 weeks", "Once every 3 weeks", "Once a month", "Once every 6 weeks", "Once every 2 months")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Wound dressing frequency");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Wound dressing frequency</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Wound dressing frequency" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            set @child7_concept_id = 0;
            set @child8_concept_id = 0;
            set @child9_concept_id = 0;
            set @child10_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Daily" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="4 times a week" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="3 times a week" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="2 times a week" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="Once a week" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="Once every 2 weeks" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child7_concept_id from concept_name where name ="Once every 3 weeks" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child8_concept_id from concept_name where name ="Once a month" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child9_concept_id from concept_name where name ="Once every 6 weeks" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child10_concept_id from concept_name where name ="Once every 2 months" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
            call add_concept_answer(@concept_id, @child7_concept_id, 7);
            call add_concept_answer(@concept_id, @child8_concept_id, 8);
            call add_concept_answer(@concept_id, @child9_concept_id, 9);
            call add_concept_answer(@concept_id, @child10_concept_id, 10);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124113942" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Orthopaedic consultation", "Osteomyelitis consultation", "Pain management consultation", "Plastic consultation", "MH consultation")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Specialised consultation");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Specialised consultation</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Specialised consultation" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Orthopaedic consultation" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Osteomyelitis consultation" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Pain management consultation" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="Plastic consultation" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="MH consultation" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124114355" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Urgent", "Non urgent")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Orthopaedic consultation timing");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Orthopaedic consultation timing</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Orthopaedic consultation timing" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Urgent" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Non urgent" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124114855" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Urgent", "Non urgent")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Osteomyelitis consultation timing");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Osteomyelitis consultation timing</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Osteomyelitis consultation timing" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Urgent" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Non urgent" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124115240" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Urgent", "Non urgent")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Pain management consultation timing");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Pain management consultation timing</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Pain management consultation timing" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Urgent" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Non urgent" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124115560" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Urgent", "Non urgent")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Plastic consultation timing");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Plastic consultation timing</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Plastic consultation timing" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Urgent" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Non urgent" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124115884" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Urgent", "Non urgent")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, MH consultation timing");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, MH consultation timing</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, MH consultation timing" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Urgent" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Non urgent" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124116191" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Yes", "No")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Patient sent to IPD");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Patient sent to IPD</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Patient sent to IPD" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Yes" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="No" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124117903" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("End of care/Cured", "Transfer", "Defaulter", "DAMA", "Dismissal", "Death")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Discharge status");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Discharge status</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Discharge status" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="End of care/Cured" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Transfer" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Defaulter" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="DAMA" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="Dismissal" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="Death" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124119710" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("MOH", "UNRWA", "NGO", "MSFOCB", "WHO", "Other")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "PPN, Referral location");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to PPN, Referral location</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "PPN, Referral location" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="MOH" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="UNRWA" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="NGO" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="MSFOCB" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="WHO" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="Other" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124119723" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_reference_term
                where code in
                ("5240","159","151596","162129","1693","1692","159619","164181","164244","1283","1694","120593","160523","160285","162937","135688","162688","156785","162749","1695","166577","113919","166580","166728")
                and retired = 0
                and concept_source_id = (
                select concept_source_id from concept_reference_source where name = "CEIL"  and retired =0
                );
            </sqlCheck>
        </preConditions>
        <comment>Adding CEIL codes to concepts</comment>
        <sql>
            SELECT concept_source_id INTO @source_id FROM concept_reference_source where name = "CEIL";

            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"5240",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"159",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"151596",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"162129",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1693",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1692",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"159619",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"164181",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"164244",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1283",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1694",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"120593",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"160523",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"160285",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"162937",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"135688",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"162688",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"156785",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1883",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"162749",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1695",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"166577",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"113919",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"166580",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"166728",@source_id,uuid(),now());
            call CREATE_REFERENCE_MAPPING_CEIL("Open non-healing wound","162937");
            call CREATE_REFERENCE_MAPPING_CEIL("PTI","156785");
            call CREATE_REFERENCE_MAPPING_CEIL("Clips removal","166728");
            call CREATE_REFERENCE_MAPPING_CEIL("Dressing","151596");
            call CREATE_REFERENCE_MAPPING_CEIL("WHO","166580");
            call CREATE_REFERENCE_MAPPING_CEIL("PPN, FLACC scale","166588");
            call CREATE_REFERENCE_MAPPING_CEIL("PPN, Discharge status","1695");
            call CREATE_REFERENCE_MAPPING_CEIL("Background pain","120593");
            call CREATE_REFERENCE_MAPPING_CEIL("PPN, DN4","166587");
            call CREATE_REFERENCE_MAPPING_CEIL("UNRWA","166578");
            call CREATE_REFERENCE_MAPPING_CEIL("DAMA","1694");
            call CREATE_REFERENCE_MAPPING_CEIL("PPN, Date","162869");
            call CREATE_REFERENCE_MAPPING_CEIL("End of care/Cured","1692");
            call CREATE_REFERENCE_MAPPING_CEIL("Surgical procedure","159619");
            call CREATE_REFERENCE_MAPPING_CEIL("PPN, Visual analog scale","166589");
            call CREATE_REFERENCE_MAPPING_CEIL("Procedural pain","160285");
            call CREATE_REFERENCE_MAPPING_CEIL("Lab request","1283");
            call CREATE_REFERENCE_MAPPING_CEIL("PPN, Pain management","162688");
            call CREATE_REFERENCE_MAPPING_CEIL("SSI","113919");
            call CREATE_REFERENCE_MAPPING_CEIL("Suture removal","166728");
            call CREATE_REFERENCE_MAPPING_CEIL("PPN, Treatment plan comment","162749");
            call CREATE_REFERENCE_MAPPING_CEIL("Death","159");
            call CREATE_REFERENCE_MAPPING_CEIL("PPN, Type of visit","164181");
            call CREATE_REFERENCE_MAPPING_CEIL("MOH","166577");
            call CREATE_REFERENCE_MAPPING_CEIL("Sedation","164244");
            call CREATE_REFERENCE_MAPPING_CEIL("Wound infection","135688");
            call CREATE_REFERENCE_MAPPING_CEIL("Wound intact and healing","162129");
            call CREATE_REFERENCE_MAPPING_CEIL("Follow-up","160523");
            call CREATE_REFERENCE_MAPPING_CEIL("NGO","166576");
            call CREATE_REFERENCE_MAPPING_CEIL("Transfer","1693");
            call CREATE_REFERENCE_MAPPING_CEIL("Defaulter","5240");
        </sql>
    </changeSet>

    <changeSet id="GAZA_CONFIG_20221115124119734" author="Shobana">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="6">
                select count(*) from concept_reference_term
                where code in
                ("MSFF361","MSFF350","MSFF366","MSFF368","MSFF367","MSFF362")
                and retired = 0
                and concept_source_id = (
                select concept_source_id from concept_reference_source where name = "MSFOCP"  and retired =0
                );
            </sqlCheck>
        </preConditions>
        <comment>Adding MSFOCP codes to concepts</comment>
        <sql>
            SELECT concept_source_id INTO @source_id FROM concept_reference_source where name = "MSFOCP";

            call CREATE_REFERENCE_MAPPING_MSFOCP("PPN, Pain management consultation timing","MSFF368");
            call CREATE_REFERENCE_MAPPING_MSFOCP("PPN, Plastic consultation timing","MSFF362");
            call CREATE_REFERENCE_MAPPING_MSFOCP("PPN, Osteomyelitis consultation timing","MSFF367");
            call CREATE_REFERENCE_MAPPING_MSFOCP("PPN, Transportation need","MSFF350");
            call CREATE_REFERENCE_MAPPING_MSFOCP("PPN, Orthopaedic consultation timing","MSFF366");
            call CREATE_REFERENCE_MAPPING_MSFOCP("PPN, Patient sent to IPD","MSFF361");
        </sql>
    </changeSet>

</databaseChangeLog>
